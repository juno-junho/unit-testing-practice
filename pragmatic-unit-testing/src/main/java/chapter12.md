# 12장. 테스트 주도 개발

작성하려는 코드가 있따면 항상 먼저 어떻게 그 코드를 테스트할지 고민해야한다.

**코드를 작성한 후에 어떻게 테스트할지 고민하기보다 작성할 코드를 묘사하는 테스트를 설계해야한다.**

이것이 테스트 주도 개발에 기반을 둔 단위 테스트 전략의 핵심이다.

TDD에서 단위 테스트를 시스템의 모양을 잡고 통제하는 도구로 활용해야 한다.

단위 테스트는 소프트웨어를 어떻게 만들어야 할지에 관한 잘 훈련된 사이클의 핵심적인 부분이다.

따라서 TDD를 채택하면 소프트웨어 설계는 달라지고 아마 더 좋아질 것이다.

(1) TDD의 주된 이익

코드를 깨끗하게 유지하도록 치열하게 싸우지 않으면 시스템은 대개 점점 퇴화한다.

TDD에서는 코드가 변경될 것이라는 두려움을 지울 수 있다.

리펙토링은 위험 부담이 있는 일이기도 하고 우리는 일견 위험하지 않아 보이는 변경을 할 때도 실수를 많이 한다.

하지만 TDD를 잘 따르면 실질적으로 모든 사례에 대해 단위테스트를 작성하게 된다.

→ 단위테스트는 코드를 지속적으로 발전 시킬 수 있는 자유를 준다.

실패하는 테스트 코드 작성하기 → 테스트 통과시키기 → 이전 두 단계에서 추가되거나 변경된 코드 개선하기

테스트 작성 → 최소한으로 프로덕션 코드 고쳐  테스트 통과되게 만들기 → git 커밋

**각 실패하는 테스트에 대해 그 테스트를 통과할 수 있는 코드만 추가해라**

**가능한 가장 작은 증분(increment)을 추가하는 것이다**

테스트가 나타나는 명세를 정확히 코딩해라.

테스트가 모두 통과한다면 잠재적으로 코드 배포 가능.

그 시점에서는 테스트는 시스템이 무엇을 하는지 문서화 한다.

가장 작은 양의 코드를 작성하는 것은 대부분 먼저 실패하는 또 다른 테스트를 만들 수 있다는 의미.

필요한 것보다 더 많은 코드를 작성하는 것은 즉시 통과할 수 있는 많은 테스트를 스스로 만들 수 있다는 의미.

적절판 피드백을 받기 전에 많은 양의 코드를 작성하는 것은 옜 방식으로 돌아가는 것. 결함 있는 코드를 작성할 때는 바로 알아내는것이 더 좋다.

→ 두 번째 테스트 통과한 후에 코드 정리.

테스트는 짧고 깔끔해야 한다.

→ TDD는 거의 모든 코드에 안전한 리팩토링을 가능하게 한다.

TDD로 성공하려면 이들 시나리오를 테스트로 만들고 각 테스트를 통과하게 만드는 코드 증분을 최소화하는 순으로 코드를 작성하는 것이다.

TDD로 생각하는 부분의 일부는 작성할 필요가 있는 다음 테스트를 결정하는 것이다.

프로그래머로서 임무는 코드가 다루어야 하는 모든 가능한 순열과 시나리오를 이해하는 것이다.

각 테스트를  통과하게 만드는 코드 증분을 최소화 하는 순으로 코드를 작성해라.

→ `Profile` 객체가 다수의 `Answer` 가지려면 저장하고 구별할수 있어야 한다 → Map에 <String, Answer>로 가지고 있도록.

테스트 이름들을 보고 클래스의 동작에 관해 빠르게 답할 수 있다.

세심하게 테스트를 작성할 수록, 테스트는 클래스에 의도적으로 설계된 동작들을 더 많이 문서화 할 수 있다.

테스트 주도 클래스를 더 잘 이해하려면 테스트 이름부터 살펴보아라.

포괄적인 테스트이름의 집합은 그 클래스의 의도된 용량을 전체적인 관점 요약으로 제공한다.

테스트 이름이 다른 것들과 함께 깔끔하고 일관성이 있을 수록 더 신뢰할 수 있는 클래스 문서가 된다.

테스트 이름은 더 좋아질 수 있다.

그리고 테스트들을 한 클래스가 아닌 여러 클래스로 나눌 수 있다 (`Profile_xx` 클래스 처럼.)

정기적으로 테스트 이름이 서로 잘 어울리는지 확인해라.

TDD 사이클은 짧다. 각 단계에서 추가되거나 변경된 코드 증분도 비교적 작다.

나쁜 코드는 버려라. 테스트를 가설로 한 시간 제한이 있는 실험으로 TDD 사이클을 취급해라.

실험이 엉망이 되면 다시 시작해 가정의 범위를 축소하면 (좀 더 작은 단계) 무엇이 잘못되었는지 찾는데 도움이 된다.